SecRule REQUEST_URI|ARGS|REQUEST_BODY "THEO_SUPER_SPECIAL_STRING" "id:1002,phase:2,log,deny,msg:'THEO TEST PASSED'"

SecRule REQUEST_URI|ARGS|REQUEST_BODY "Generals are stealing supplies to sell on the black market" "id:1003,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "Berylia is defenceless against the might" "id:1004,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "Have you surrendered yet" "id:1005,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "Corruption of our government needs to stop" "id:1006,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "tired of our corrupt elites" "id:1007,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "stop them from torturing us" "id:1008,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "Berylians want to be in Crimsonia" "id:1009,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "will be better off as part of Crimsonia" "id:1010,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "the fight for justice in Berylia" "id:1011,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "stop the torture and corruption" "id:1012,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "our government from torturing us" "id:1013,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "Berylian people are asking for help" "id:1014,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "your government can't provide your family safety" "id:1015,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "poppe te" "id:1016,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "POPETE" "id:1017,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "poppete" "id:1018,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "Crimsonia forever" "id:1019,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|ARGS|REQUEST_BODY "your government can't provide your family safety" "id:1020,phase:2,log,deny,msg:'Threat Hunting Blacklist'"

SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "pastebin.berylia.org" "id:1021,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "upload.berylia.org" "id:1022,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "100.101.0.32" "id:1023,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "100.101.0.89" "id:1024,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "100.101.0.41" "id:1025,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "100.101.0.111" "id:1026,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "2a07:1182:101::89" "id:1027,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "2a07:1182:101::111" "id:1028,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "2a07:1182:101::32" "id:1029,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "2a07:1182:101::41" "id:1030,phase:2,log,deny,msg:'Threat Hunting Blacklist'"
SecRule REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS "2a07:1182:101::24" "id:1031,phase:2,log,deny,msg:'Threat Hunting Blacklist'"

# 1) laisser passer /captcha et /healthz
SecRule REQUEST_URI "@beginsWith /captcha" \
  "id:10001,phase:1,pass,nolog,ctl:ruleEngine=Off"
SecRule REQUEST_URI "@beginsWith /healthz" \
  "id:10002,phase:1,pass,nolog,ctl:ruleEngine=Off"

# 2) absent → 418
SecRule &REQUEST_COOKIES:captcha_verified "@eq 0" \
  "id:10010,phase:1,deny,log,status:418,msg:'Captcha cookie missing'"

# 3) décodage + suppression explicite de \n
SecRule REQUEST_COOKIES:captcha_verified "@rx .+" \
  "id:10011,phase:1,pass,nolog,capture,\
   t:base64DecodeExt,\
   t:trim,\
   setvar:tx.captcha_val=%{TX.0}"

# 4a) bonne valeur → pass
SecRule TX:captcha_val "@streq unboncookievautmieuxquedeuxtular" \
  "id:10012,phase:1,pass,nolog"

SecRule TX:captcha_val "!@streq unboncookievautmieuxquedeuxtular" \
  "id:10013,phase:1,deny,log,status:418,\
   msg:'Captcha required',\
   logdata:'raw_cookie=%{REQUEST_COOKIES.captcha_verified} decoded=%{TX.captcha_val}'"

